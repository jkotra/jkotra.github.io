<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><base href=/posts/https_parse_openssl/><meta name=description content="Integrate TLS with TCP to securely communicate ðŸ”’"><meta name=language content="en"><link rel=sitemap type=application/xml title=Sitemap href=/sitemap.xml><title>Parse HTTPS website(s) in C with OpenSSL :: &lt;stdin></title><link rel=icon type=image/png href=/static/chip.png><meta property="og:title" content="Parse HTTPS website(s) in C with OpenSSL"><meta property="og:description" content="Integrate TLS with TCP to securely communicate ðŸ”’"><meta property="og:type" content="article"><meta property="og:url" content="/posts/https_parse_openssl/"><meta property="og:image" content="https://i.imgur.com/YGtDgXv.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-09-20T20:07:40+05:30"><meta property="article:modified_time" content="2020-09-20T20:07:40+05:30"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://i.imgur.com/YGtDgXv.png"><meta name=twitter:title content="Parse HTTPS website(s) in C with OpenSSL"><meta name=twitter:description content="Integrate TLS with TCP to securely communicate ðŸ”’"><meta name=theme-color content="#2e2847"><link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:200,300" rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Tangerine&display=swap" rel=stylesheet><script src=/js/main.min.f8a31813e8097da432d631743cdb3eb23254823b561107d20d1e7c7ff648b1adbfdce37b9c6846505abf6476d90b9a5e0b26356dc195e8416276eb962c21dc23.js integrity="sha512-+KMYE+gJfaQy1jF0PNs+sjJUgjtWEQfSDR58f/ZIsa2/3ON7nGhGUFq/ZHbZC5peCyY1bcGV6EFiduuWLCHcIw=="></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/fontawesome.min.css integrity="sha512-8jdwayz5n8F2cnW26l9vpV6+yGOcRAqz6HTu+DQ3FtVIAts2gTdlFZOGpYhvBMXkWEgxPN3Y22UWyZXuDowNLA==" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/regular.min.css integrity="sha512-qgtcTTDJDk6Fs9eNeN1tnuQwYjhnrJ8wdTVxJpUTkeafKKP6vprqRx5Sj/rB7Q57hoYDbZdtHR4krNZ/11zONg==" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/brands.min.css integrity="sha512-AMDXrE+qaoUHsd0DXQJr5dL4m5xmpkGLxXZQik2TvR2VCVKT/XRPQ4e/LTnwl84mCv+eFm92UG6ErWDtGM/Q5Q==" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/solid.min.css integrity="sha512-QN7X/bUbbeel9bbq6JVNJXk1Zowt+n+QPN+DjhEmTa4TdL1YPCsCey5JrvfRW8xp28LDYgGG/waNVdrhwMQmVQ==" crossorigin=anonymous><link rel=stylesheet type=text/css media=screen href=/css/main.min.48edec8e71e3c4241e1b0e5297e0493ecf3422ea88498be6299a2c179da318ff1deeab1ac48440d4a90cac8eb33c4545b985c687109953783b142fea4819c6f5.css integrity="sha512-SO3sjnHjxCQeGw5Sl+BJPs80IuqISYvmKZosF52jGP8d7qsaxIRA1KkMrI6zPEVFuYXGhxCZU3g7FC/qSBnG9Q=="><link rel=stylesheet type=text/css media=screen href=/css/custom.min.3e90b71df5994759c01a2c012d044795212a2436d2b36597893f83e31af62525d4571cc4135b3c4c2c634e0101d0c8e04be3d971ac8378e1ca15bf7d67d64eea.css integrity="sha512-PpC3HfWZR1nAGiwBLQRHlSEqJDbSs2WXiT+D4xr2JSXUVxzEE1s8TCxjTgEB0MjgS+PZcayDeOHKFb99Z9ZO6g=="><link rel=stylesheet type=text/css href=/css/dark.min.a6e1132ca354fccc5b438d5409cb8472d273c4d4df9bfc966733b6834ac01013a955ce583e386b9ed5bc2a5217255129b6389867b03bfa3b19ed78677816669a.css media="(prefers-color-scheme: dark)"><link rel=stylesheet type=text/css media=screen href=/css/normalize.min.6b1cdb85ff89a0a19c4454992a82369dff0499f92605e8468157247c4d8920ad3577edea733674d303c5e7901508bdfd2a97c2da55e94c14f3dc8b658d9b2c5a.css integrity="sha512-axzbhf+JoKGcRFSZKoI2nf8EmfkmBehGgVckfE2JIK01d+3qczZ00wPF55AVCL39KpfC2lXpTBTz3ItljZssWg=="><script async src="https://www.googletagmanager.com/gtag/js?id=G-YW8V9DTR0N"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config',"G-YW8V9DTR0N")</script><script data-ad-client=ca-pub-8658473214995139 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><div class="container wrapper"><div class=header><base href=/><h1 class=site-title><a href=/>&lt;stdin></a>
<span class=blinking-cursor>|</span></h1><div class=site-description><h2 class=cursive>My Thoughts, Trials and Adventures</h2><nav class="nav social"><ul class=flat><a href=mailto:jagadeesh@stdin.top title=Mail><i class="far fa-envelope"></i></a><a href=https://github.com/jkotra/ title=Github><i class="fab fa-github"></i></a><a href=https://twitter.com/jagadeesh_kotra title=Twitter><i class="fab fa-twitter"></i></a><a href=index.xml title=RSS><i class="fas fa-rss"></i></a></ul></div><nav class=nav><ul class=flat><li><a href=/about/>About</a></li><li><a href=/tags/>Tags</a></li><li><a href=/portfolio/>Portfolio</a></li><li><a href=http://lab.stdin.top>Lab</a></li><li><a href=/pgp/>PGP</a></li></ul></nav></div><div class=post><div class=post-header><h1 class=title>Parse HTTPS website(s) in C with OpenSSL</h1><div class=meta>Posted at &mdash; Sep 20, 2020</div></div><div class=markdown><h1 id=introduction>Introduction</h1><p>In this article, I will explain how to parse a website that uses <code>HTTPS</code>. in the process, one must get a grip on OpenSSL and integrating it with TCP (TLS) to retrieve content.</p><h1 id=openssl>OpenSSL</h1><blockquote><p>OpenSSL is a software library for applications that secure communications over computer networks against eavesdropping or need to identify the party at the other end. It is widely used by Internet servers, including the majority of HTTPS websites.</p></blockquote><p><a href=https://en.wikipedia.org/wiki/OpenSSL>Source</a></p><h2 id=parsing-from-https-website>Parsing from <code>HTTPS</code> website</h2><div class="notices note"><p>the code explained here can be found in my <a href=https://github.com/jkotra/NetworkProgramming/blob/master/tls/get_https_webpage.c>NetworkProgramming GitHub repository</a>.</p></div><h3 id=tls>TLS</h3><blockquote><p>Transport Layer Security, and its now-deprecated predecessor, Secure Sockets Layer, are cryptographic protocols designed to provide communications security over a computer network. Several versions of the protocols find widespread use in applications such as web browsing, email, instant messaging, and voice over IP.</p></blockquote><p><a href=https://en.wikipedia.org/wiki/Transport_Layer_Security>Source</a></p><h3 id=walkthrough>Walkthrough</h3><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#099>#include</span> <span style=color:#099>&lt;openssl/x509.h&gt;</span><span style=color:#099>
</span><span style=color:#099>#include</span> <span style=color:#099>&lt;openssl/crypto.h&gt;</span><span style=color:#099>
</span><span style=color:#099>#include</span> <span style=color:#099>&lt;openssl/pem.h&gt;</span><span style=color:#099>
</span><span style=color:#099>#include</span> <span style=color:#099>&lt;openssl/ssl.h&gt;</span><span style=color:#099>
</span><span style=color:#099>#include</span> <span style=color:#099>&lt;openssl/err.h&gt;</span><span style=color:#099>
</span><span style=color:#099>#include</span> <span style=color:#099>&lt;openssl/evp.h&gt;</span><span style=color:#099>
</span><span style=color:#099></span>
<span style=color:#099>#include</span> <span style=color:#099>&lt;sys/types.h&gt;</span><span style=color:#099>
</span><span style=color:#099>#include</span> <span style=color:#099>&lt;sys/socket.h&gt;</span><span style=color:#099>
</span><span style=color:#099>#include</span> <span style=color:#099>&lt;sys/select.h&gt;</span><span style=color:#099>
</span><span style=color:#099>#include</span> <span style=color:#099>&lt;netinet/in.h&gt;</span><span style=color:#099>
</span><span style=color:#099>#include</span> <span style=color:#099>&lt;netdb.h&gt;</span><span style=color:#099>
</span><span style=color:#099></span>
<span style=color:#099>#include</span> <span style=color:#099>&lt;stdio.h&gt;</span><span style=color:#099>
</span><span style=color:#099>#include</span> <span style=color:#099>&lt;string.h&gt;</span><span style=color:#099>
</span><span style=color:#099>#include</span> <span style=color:#099>&lt;unistd.h&gt;</span><span style=color:#099>
</span><span style=color:#099>#include</span> <span style=color:#099>&lt;stdbool.h&gt;</span><span style=color:#099>
</span><span style=color:#099>#include</span> <span style=color:#099>&lt;errno.h&gt;</span><span style=color:#099>
</span></code></pre></div><p>We start by importing the required headers. Notice the OpenSSL headers, these contain essential functions to communicate securely with the website.</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#078;font-weight:700>int</span> <span style=color:#c0f>main</span>(<span style=color:#078;font-weight:700>int</span> argc, <span style=color:#078;font-weight:700>char</span> <span style=color:#555>*</span>argv[])
{

    <span style=color:#09f;font-style:italic>// ssl initialization.
</span><span style=color:#09f;font-style:italic></span>    SSL_library_init();
    OpenSSL_add_all_algorithms();
</code></pre></div><p><code>main()</code> function takes two arguments, a domain name/ IP and a port/protocol. SSL port is <code>443</code>. we can also use <code>https</code>(which defaults to <code>443</code>) as the port. <code>getaddrinfo()</code> will understand it either way.</p><p>we need to initialize two functions, <code>SSL_library_init()</code> will set up the environment to use other functions of OpenSSL. <code>OpenSSL_add_all_algorithms()</code> will load required algorithms to encrypt, decrypt data and negotiate cipher with server.</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>    <span style=color:#09f;font-style:italic>//init context
</span><span style=color:#09f;font-style:italic></span>    SSL_CTX <span style=color:#555>*</span>ctx <span style=color:#555>=</span> SSL_CTX_new(TLS_client_method());
    <span style=color:#069;font-weight:700>if</span> (<span style=color:#555>!</span>ctx)
    {
        printf(<span style=color:#c30>&#34;cannot create SSL context!</span><span style=color:#c30;font-weight:700>\n</span><span style=color:#c30>&#34;</span>);
        <span style=color:#069;font-weight:700>return</span> <span style=color:#f60>1</span>;
    }
</code></pre></div><p>we then need to initialize a context using <code>SSL_CTX_new()</code>. we pass a inbuilt constructor, <code>TLS_client_method()</code> indicating that we expect a client functionality.</p><div class="notices info"><p><p><code>TLS_method(), TLS_server_method(), TLS_client_method()</code></p><p>These are the general-purpose version-flexible SSL/TLS methods. The actual protocol version used will be negotiated to the highest version mutually supported by the client and the server. The supported protocols are SSLv3, TLSv1, TLSv1.1 and TLSv1.2. Applications should use these methods, and avoid the version-specific methods described below.</p><p><a href=https://www.openssl.org/docs/man1.1.0/man3/TLS_client_method.html>Source</a></p></p></div><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>    <span style=color:#09f;font-style:italic>/* code taken from tcp_client_classic.c */</span>
    <span style=color:#069;font-weight:700>struct</span> addrinfo hints;

    memset(<span style=color:#555>&amp;</span>hints, <span style=color:#f60>0</span>, <span style=color:#069;font-weight:700>sizeof</span>(hints));

    <span style=color:#069;font-weight:700>struct</span> addrinfo <span style=color:#555>*</span>peer;
    hints.ai_socktype <span style=color:#555>=</span> SOCK_STREAM;

    printf(<span style=color:#c30>&#34;args: %s %s</span><span style=color:#c30;font-weight:700>\n</span><span style=color:#c30>&#34;</span>, argv[<span style=color:#f60>1</span>], argv[<span style=color:#f60>2</span>]);

    <span style=color:#069;font-weight:700>if</span> (getaddrinfo(argv[<span style=color:#f60>1</span>], argv[<span style=color:#f60>2</span>], <span style=color:#555>&amp;</span>hints, <span style=color:#555>&amp;</span>peer) <span style=color:#555>&lt;</span> <span style=color:#f60>0</span>)
    {

        printf(<span style=color:#c30>&#34;addrinfo() error!</span><span style=color:#c30;font-weight:700>\n</span><span style=color:#c30>&#34;</span>);
        <span style=color:#069;font-weight:700>return</span> <span style=color:#f60>1</span>;
    }

    <span style=color:#078;font-weight:700>char</span> peer_addr[<span style=color:#f60>100</span>];
    <span style=color:#078;font-weight:700>char</span> peer_protocol[<span style=color:#f60>100</span>];
    getnameinfo(peer<span style=color:#555>-&gt;</span>ai_addr, peer<span style=color:#555>-&gt;</span>ai_addrlen, peer_addr, <span style=color:#069;font-weight:700>sizeof</span>(peer_addr), peer_protocol, <span style=color:#069;font-weight:700>sizeof</span>(peer_protocol), NI_NUMERICHOST);

    printf(<span style=color:#c30>&#34;ip: %s | protocol: %s</span><span style=color:#c30;font-weight:700>\n</span><span style=color:#c30>&#34;</span>, peer_addr, peer_protocol);

    <span style=color:#09f;font-style:italic>//family socket_type protocol
</span><span style=color:#09f;font-style:italic></span>    <span style=color:#078;font-weight:700>int</span> socket_fd <span style=color:#555>=</span> socket(peer<span style=color:#555>-&gt;</span>ai_family, peer<span style=color:#555>-&gt;</span>ai_socktype, peer<span style=color:#555>-&gt;</span>ai_protocol);

    <span style=color:#069;font-weight:700>if</span> (socket_fd <span style=color:#555>&lt;</span> <span style=color:#f60>0</span>)
    {
        printf(<span style=color:#c30>&#34;socket error.</span><span style=color:#c30;font-weight:700>\n</span><span style=color:#c30>&#34;</span>);
        <span style=color:#069;font-weight:700>return</span> <span style=color:#f60>1</span>;
    }

    <span style=color:#069;font-weight:700>if</span> (connect(socket_fd, peer<span style=color:#555>-&gt;</span>ai_addr, peer<span style=color:#555>-&gt;</span>ai_addrlen) <span style=color:#555>&lt;</span> <span style=color:#f60>0</span>)
    {
        printf(<span style=color:#c30>&#34;connect error.</span><span style=color:#c30;font-weight:700>\n</span><span style=color:#c30>&#34;</span>);
        <span style=color:#069;font-weight:700>return</span> <span style=color:#f60>1</span>;
    }

    printf(<span style=color:#c30>&#34;connected!</span><span style=color:#c30;font-weight:700>\n</span><span style=color:#c30>&#34;</span>);

    <span style=color:#09f;font-style:italic>/* END */</span>
</code></pre></div><p>The above code is directly taken from <code>tcp_client_classic.c</code> which is explained in <a href=/posts/network-programming-pt2/>this article</a>.</p><p>this essentially initiates a connection with the server, involving address resolution, socket creation, and <code>connect()</code></p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>    SSL <span style=color:#555>*</span>ssl <span style=color:#555>=</span> SSL_new(ctx);
    <span style=color:#069;font-weight:700>if</span> (<span style=color:#555>!</span>ctx)
    {
        fprintf(stderr, <span style=color:#c30>&#34;SSL_new() failed.</span><span style=color:#c30;font-weight:700>\n</span><span style=color:#c30>&#34;</span>);
        <span style=color:#069;font-weight:700>return</span> <span style=color:#f60>1</span>;
    }
</code></pre></div><p>next, we create an <code>SSL</code> pointer for peer(server). this will be used to communicate with the server replacing a <code>socket_fd</code>.</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>    <span style=color:#069;font-weight:700>if</span> (<span style=color:#555>!</span>SSL_set_tlsext_host_name(ssl, argv[<span style=color:#f60>1</span>]))
    {
        fprintf(stderr, <span style=color:#c30>&#34;SSL_set_tlsext_host_name() failed.</span><span style=color:#c30;font-weight:700>\n</span><span style=color:#c30>&#34;</span>);

        <span style=color:#069;font-weight:700>return</span> <span style=color:#f60>1</span>;
    }
</code></pre></div><p>The above code will ask the server to send details only related to the required website/Hostname. This is a necessary step if multiple sites are hosted under 1(single) IP. The server will then send a certificate pertaining to the hostname provided. it&rsquo;s up to us(client) to validate the details.</p><p>Usually, a self-signed certificate cannot be trusted, every OS comes with a set of trusted CA(certificate authorities) that are to be trusted. the client also must verify that the certificate is valid and not expired or yet-to-be issued.</p><p>(certificate validation is not covered in this article)</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>    SSL_set_fd(ssl, socket_fd);
    <span style=color:#069;font-weight:700>if</span> (SSL_connect(ssl) <span style=color:#555>==</span> <span style=color:#555>-</span><span style=color:#f60>1</span>)
    {
        fprintf(stderr, <span style=color:#c30>&#34;SSL_connect() failed.</span><span style=color:#c30;font-weight:700>\n</span><span style=color:#c30>&#34;</span>);
        <span style=color:#069;font-weight:700>return</span> <span style=color:#f60>1</span>;
    }
</code></pre></div><p>In the above step, we connect our TCP socket to <code>SSL</code> using <code>SSL_set_fd</code>. from this point onwards (after <code>SSL_connect()</code>) we can communicate securely.</p><p><code>ssl_connect()</code> negotiates the best possible and mutually accepted cipher to decrypt and encrypt.it returns <code>-1</code> on error.</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>printf(<span style=color:#c30>&#34;SSL/TLS using %s</span><span style=color:#c30;font-weight:700>\n</span><span style=color:#c30>&#34;</span>, SSL_get_cipher(ssl));
</code></pre></div><p>(Optional) print the cipher being used using <code>SSL_get_cipher()</code></p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#078;font-weight:700>char</span> buffer[<span style=color:#f60>2048</span>];

    sprintf(buffer, <span style=color:#c30>&#34;GET / HTTP/1.1</span><span style=color:#c30;font-weight:700>\r\n</span><span style=color:#c30>&#34;</span>);
    sprintf(buffer <span style=color:#555>+</span> strlen(buffer), <span style=color:#c30>&#34;Host: %s:%s</span><span style=color:#c30;font-weight:700>\r\n</span><span style=color:#c30>&#34;</span>, argv[<span style=color:#f60>1</span>], argv[<span style=color:#f60>2</span>]);
    sprintf(buffer <span style=color:#555>+</span> strlen(buffer), <span style=color:#c30>&#34;Connection: close</span><span style=color:#c30;font-weight:700>\r\n</span><span style=color:#c30>&#34;</span>);
    sprintf(buffer <span style=color:#555>+</span> strlen(buffer), <span style=color:#c30>&#34;User-Agent: https_simple</span><span style=color:#c30;font-weight:700>\r\n</span><span style=color:#c30>&#34;</span>);
    sprintf(buffer <span style=color:#555>+</span> strlen(buffer), <span style=color:#c30>&#34;</span><span style=color:#c30;font-weight:700>\r\n</span><span style=color:#c30>&#34;</span>);

    SSL_write(ssl, buffer, strlen(buffer));
    printf(<span style=color:#c30>&#34;Sent Headers:</span><span style=color:#c30;font-weight:700>\n</span><span style=color:#c30>%s&#34;</span>, buffer);

    <span style=color:#078;font-weight:700>int</span> bytes_received <span style=color:#555>=</span> SSL_read(ssl, buffer, <span style=color:#069;font-weight:700>sizeof</span>(buffer));
    <span style=color:#069;font-weight:700>if</span> (bytes_received <span style=color:#555>&lt;</span> <span style=color:#f60>1</span>)
    {
        printf(<span style=color:#c30>&#34;</span><span style=color:#c30;font-weight:700>\n</span><span style=color:#c30>Connection closed by peer.</span><span style=color:#c30;font-weight:700>\n</span><span style=color:#c30>&#34;</span>);
    }

    printf(<span style=color:#c30>&#34;Received (%d bytes): &#39;%.*s&#39;</span><span style=color:#c30;font-weight:700>\n</span><span style=color:#c30>&#34;</span>, bytes_received, bytes_received, buffer);
</code></pre></div><p>The above code<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> declares a buffer. the buffer is filled with requred HTTP headers to make a request. <code>send()</code> is replaced by <code>SSL_write()</code> and <code>recv()</code> is replaced by <code>SSL_read()</code>.</p><p>the response is then stored into the <code>buffer</code>. the response is printed onto the screen.</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c>    <span style=color:#09f;font-style:italic>// shutdown ssl connection and free() ctx. 
</span><span style=color:#09f;font-style:italic></span>    SSL_shutdown(ssl);
    SSL_free(ssl);
    SSL_CTX_free(ctx);
    
    <span style=color:#09f;font-style:italic>// close socket
</span><span style=color:#09f;font-style:italic></span>    close(socket_fd);

    <span style=color:#069;font-weight:700>return</span> <span style=color:#f60>0</span>;
}
</code></pre></div><p>Finally, we must clean up pointers n stuff, starting with OpenSSL. shutdown the current SSL connection using <code>SSL_shutdown()</code>, then free it from memory i.e <code>SSL_free(ssl)</code>. SSL context that is used to create SSL should be free&rsquo;d (since we are exiting the application, keep it around if you don&rsquo;t). Finally, as always, close the socket using <code>close()</code></p><h3 id=output>Output</h3><p>compile the program with GCC (remember to link with openSSL library)</p><p><code>gcc get_https_webpage.c -lcrypto -lssl</code></p><p>Run the program:</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>~/Documents/Projects/network_programming/tls(master) Â» ./a.out example.org 443                                            jojo@synk
args: example.org 443
ip: 93.184.216.34 | protocol: https
connected!
SSL/TLS using TLS_AES_256_GCM_SHA384
Sent Headers:
GET / HTTP/1.1
Host: example.org:443
Connection: close
User-Agent: https_simple

Received (370 bytes): &#39;HTTP/1.1 200 OK
Accept-Ranges: bytes
Age: 361373
Cache-Control: max-age=604800
Content-Type: text/html; charset=UTF-8
Date: Mon, 21 Sep 2020 18:13:25 GMT
Etag: &#34;3147526947&#34;
Expires: Mon, 28 Sep 2020 18:13:25 GMT
Last-Modified: Thu, 17 Oct 2019 07:18:26 GMT
Server: ECS (nyb/1D1B)
Vary: Accept-Encoding
X-Cache: HIT
Content-Length: 1256
Connection: close

&#39;

</code></pre></div><p>Note, the response is only partial. <code>SSL_read()</code> must be run in a loop to receive until end.</p><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>Code was taken from <a href=https://github.com/codeplea/Hands-On-Network-Programming-with-C/blob/master/chap09/https_get.c>Hands-On Network Programming with C Code Repo</a> <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div><div class=post-tags><nav class="nav tags"><ul class=flat><li><a href=/tags/network-programming>network programming</a></li><li><a href=/tags/c>c</a></li></ul></nav></div><div id=commento></div><script id=comments src=https://utteranc.es/client.js repo=jkotra/stdin.top-comments issue-term=pathname label=ðŸ’¬ theme=github-light crossorigin=anonymous async></script><noscript>Please enable JavaScript to view the
<a href=https://commento.io/>comments powered by Commento.</a></noscript></div><link rel=stylesheet type=text/css href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.js></script><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script></div></div><div class="footer wrapper"><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-8658473214995139 data-ad-slot=2398602558 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><br><nav class=nav><div class=badge><a href=https://creativecommons.org/licenses/by-sa/4.0/><img src=/cc/by-sa.png></a></div><div><a href=https://gitlab.com/synk.0x1/kavi-hugo-theme>Kavi</a> (based on <a href=https://github.com/vividvilla/ezhil>ezhil</a>)</a> | Built with <a href=https://gohugo.io>Hugo</a></div></nav></div></body></html>